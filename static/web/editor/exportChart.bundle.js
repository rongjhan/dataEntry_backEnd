"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk"] = self["webpackChunk"] || []).push([["exportChart"],{

/***/ "./src/mod_exportChart/_imgUtil.mjs":
/*!******************************************!*\
  !*** ./src/mod_exportChart/_imgUtil.mjs ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"svgShowAsBackGround\": () => (/* binding */ svgShowAsBackGround),\n/* harmony export */   \"svgToPngURI\": () => (/* binding */ svgToPngURI),\n/* harmony export */   \"svgURI\": () => (/* binding */ svgURI)\n/* harmony export */ });\n/* harmony import */ var core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../node_modules/core-js/modules/es.array.iterator.js\");\n/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../node_modules/core-js/modules/es.object.to-string.js\");\n/* harmony import */ var core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../node_modules/core-js/modules/es.string.iterator.js\");\n/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../node_modules/core-js/modules/web.dom-collections.iterator.js\");\n/* harmony import */ var core_js_modules_web_url_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! core-js/modules/web.url.js */ \"../node_modules/core-js/modules/web.url.js\");\n/* harmony import */ var core_js_modules_web_url_search_params_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! core-js/modules/web.url-search-params.js */ \"../node_modules/core-js/modules/web.url-search-params.js\");\n/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! core-js/modules/es.promise.js */ \"../node_modules/core-js/modules/es.promise.js\");\n\n\n\n\n\n\n\nfunction svgURI(svgElement, uritype) {\n  //svg標籤需添加xmlns命名空間,否則用於img.src無效,用了XMLSerializer()則無此問題,其會幫你自動添加xlmns\n  //console.log(svgString)\n  var oSerializer = new XMLSerializer();\n  var svgString = oSerializer.serializeToString(svgElement);\n  if (uritype == \"dataUri\" || uritype == undefined) {\n    return 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgString)));\n    // 'data:image/svg+xml;utf8,' + encodeURIComponent(svgString) 不同編碼的dataUri\n  }\n\n  if (uritype == \"objectUri\") {\n    var blob = new Blob([svgString], {\n      type: 'image/svg+xml;charset=utf-8'\n    });\n    return URL.createObjectURL(blob);\n  }\n  //dataURI有永久性而blobURI沒有\n}\n\nfunction svgToPngURI(svgElement, uritype) {\n  var uriPromise = new Promise(function (resolve, reject) {\n    var img = new Image();\n    img.onload = function (e) {\n      //svg檔需透過canvas drawImage的方式轉成Png或其他raster檔案格式\n      var svgBOX = svgElement.getBBox();\n      //getBBox() only works when svgElemnt is shown in document,or width/height will be 0\n      console.log(svgBOX.width, svgElement.getAttribute(\"width\"));\n      console.log(svgElement.parentElement);\n      var canvas = document.createElement('canvas');\n      //以下操作為canvas對於不同裝置devicePixelRatio不同而會造成模糊所做的調整\n      var scale = window.devicePixelRatio;\n      canvas.width = svgBOX.width * scale || svgElement.getAttribute(\"width\") * scale;\n      canvas.height = svgBOX.height * scale || svgElement.getAttribute(\"height\") * scale;\n      var canvasContext = canvas.getContext('2d');\n      // canvasContext.scale(scale, scale) 有時須調整畫布的scale 此處不用\n      canvasContext.drawImage(img, 0, 0, canvas.width, canvas.height);\n      if (uritype == \"dataUri\" || uritype == undefined) {\n        resolve(canvas.toDataURL('image/png', 1.0));\n        //base64編碼的dataURI\n      }\n\n      if (uritype == \"objectUri\") {\n        canvas.toBlob(function (blob) {\n          resolve(URL.createObjectURL(blob));\n        }, 'image/png', 1.0);\n      }\n    };\n    img.src = svgURI(svgElement, \"dataUri\");\n  });\n  return uriPromise;\n}\nfunction svgShowAsBackGround(putWhere, svgElement) {\n  var put = putWhere;\n  var uri = svgURI(svgElement);\n  put.style.backgroundImage = \"url(\".concat(uri, \")\");\n  put.style.backgroundSize = \"contain\";\n  put.style.backgroundRepeat = \"no-repeat\";\n}\n\n//# sourceURL=webpack:///./src/mod_exportChart/_imgUtil.mjs?");

/***/ }),

/***/ "./src/mod_exportChart/download.mjs":
/*!******************************************!*\
  !*** ./src/mod_exportChart/download.mjs ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"descriptor\": () => (/* binding */ descriptor),\n/* harmony export */   \"produce\": () => (/* binding */ downloadChart)\n/* harmony export */ });\n/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../node_modules/core-js/modules/es.object.to-string.js\");\n/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.promise.js */ \"../node_modules/core-js/modules/es.promise.js\");\n/* harmony import */ var _imgUtil_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_imgUtil.mjs */ \"./src/mod_exportChart/_imgUtil.mjs\");\n\n\n\n\nvar descriptor = {\n  data: {\n    required: true,\n    multi: false\n  },\n  config: {\n    fileType: {\n      type: \"selection\",\n      options: [\"svg\", \"png\"],\n      defaultValue: \"png\"\n    }\n  }\n};\nfunction downloadChart(_ref) {\n  var datas = _ref.datas,\n    config = _ref.config;\n  var svgElement = datas[0];\n  var fileName = \"pic.\".concat(config.fileType);\n  switch (config.fileType) {\n    case \"png\":\n      return (0,_imgUtil_mjs__WEBPACK_IMPORTED_MODULE_2__.svgToPngURI)(svgElement, \"dataUri\").then(function (uri) {\n        var link = document.createElement(\"a\");\n        link.download = fileName;\n        link.href = uri;\n        link.click();\n        return \"success\";\n      }).catch(function (error) {\n        console.error(error);\n        return null;\n      });\n    case \"svg\":\n      return new Promise(function (resolve) {\n        var link = document.createElement(\"a\");\n        link.download = fileName;\n        link.href = (0,_imgUtil_mjs__WEBPACK_IMPORTED_MODULE_2__.svgURI)(svgElement, \"dataUri\");\n        link.click();\n        resolve(\"success\");\n      }).catch(function (error) {\n        console.error(error);\n        return null;\n      });\n  }\n}\n\n\n//# sourceURL=webpack:///./src/mod_exportChart/download.mjs?");

/***/ }),

/***/ "./src/mod_exportChart/html.mjs":
/*!**************************************!*\
  !*** ./src/mod_exportChart/html.mjs ***!
  \**************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"produce\": () => (/* binding */ downloadHtml)\n/* harmony export */ });\n/* harmony import */ var core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../node_modules/core-js/modules/es.array.iterator.js\");\n/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../node_modules/core-js/modules/es.object.to-string.js\");\n/* harmony import */ var core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../node_modules/core-js/modules/es.string.iterator.js\");\n/* harmony import */ var core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../node_modules/core-js/modules/web.dom-collections.iterator.js\");\n/* harmony import */ var core_js_modules_web_url_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! core-js/modules/web.url.js */ \"../node_modules/core-js/modules/web.url.js\");\n/* harmony import */ var core_js_modules_web_url_search_params_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! core-js/modules/web.url-search-params.js */ \"../node_modules/core-js/modules/web.url-search-params.js\");\n\n\n\n\n\n\nvar config = {};\nfunction downloadHtml(event) {\n  //only support officeOnline\n  var d3Script = document.createElement(\"script\");\n  d3Script.src = 'https://cdnjs.cloudflare.com/ajax/libs/d3/6.2.0/d3.min.js';\n  var userScript = document.createElement(\"script\");\n  userScript.type = \"text/javascript\";\n  userScript.innerText = 'var tooltip = d3.select(\".tooltip\");d3.selectAll(\"rect\").on(\"mouseover\", function(){tooltip.style(\"display\", null)}).on(\"mouseout\", function(){tooltip.style(\"display\", \"none\"); }).on(\"mousemove\", function(e){var xPosition = e.offsetX-15;var yPosition = e.offsetY-25;tooltip.attr(\"transform\", \"translate(\" + xPosition + \",\" + yPosition+ \")\");tooltip.select(\"text\").text(this.getAttribute(\"data-value\"));})';\n  var root = document.createElement(\"html\");\n  root.appendChild(document.querySelector(\".two svg\").cloneNode(deep = true));\n  root.appendChild(d3Script);\n  root.appendChild(userScript);\n  var blob = new Blob([root.outerHTML], {\n    type: \"text/html;charset=utf-8\"\n  });\n  var url = URL.createObjectURL(blob);\n  document.getElementById(\"save\").href = url;\n  //若有自訂事件則須用dispatchEvent\n}\n\n\n\n//# sourceURL=webpack:///./src/mod_exportChart/html.mjs?");

/***/ }),

/***/ "./src/mod_exportChart/insert.mjs":
/*!****************************************!*\
  !*** ./src/mod_exportChart/insert.mjs ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"descriptor\": () => (/* binding */ descriptor),\n/* harmony export */   \"produce\": () => (/* binding */ insertImg)\n/* harmony export */ });\n/* harmony import */ var _imgUtil_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_imgUtil.mjs */ \"./src/mod_exportChart/_imgUtil.mjs\");\n\nvar descriptor = {\n  data: {\n    required: true,\n    multi: false\n  },\n  config: {}\n};\nfunction insertImg(_ref) {\n  var datas = _ref.datas,\n    config = _ref.config;\n  var svgElement = datas[0];\n  return Excel.run(function (ctx) {\n    var sheet = ctx.workbook.worksheets.getActiveWorksheet();\n    var oSerializer = new XMLSerializer();\n    var svgString = oSerializer.serializeToString(svgElement);\n    sheet.shapes.addSvg(svgString);\n    //console.log(svgString)\n    // addSvg參數為svgtring,並非一個uri\n    // sheet.shapes.addSvg(svg.outerHTML),用此效果同等 不過就缺少xlmns\n\n    return ctx.sync().catch(\n    // handle officeOnline don't support addSVG\n    function () {\n      var uriPromise = (0,_imgUtil_mjs__WEBPACK_IMPORTED_MODULE_0__.svgToPngURI)(svgElement, \"dataUri\");\n      uriPromise.then(function (uri) {\n        console.log(uri);\n        sheet.shapes.addImage(uri.split(';base64,')[1]);\n        console.log(\"not support insert svg, so add png instead\");\n        //addImage參數為base64編碼圖片本身,並非一整個datauri\n        //addImage僅支援base64編碼的png或jpg或jpg,故將svgXml直接做base64編碼是不支援的\n        return ctx.sync();\n      });\n    });\n  }).then(function () {\n    return \"success\";\n  });\n}\n\n\n//# sourceURL=webpack:///./src/mod_exportChart/insert.mjs?");

/***/ }),

/***/ "./src/mod_exportChart/png.mjs":
/*!*************************************!*\
  !*** ./src/mod_exportChart/png.mjs ***!
  \*************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"descriptor\": () => (/* binding */ descriptor),\n/* harmony export */   \"produce\": () => (/* binding */ downloadPng)\n/* harmony export */ });\n/* harmony import */ var _imgUtil_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_imgUtil.mjs */ \"./src/mod_exportChart/_imgUtil.mjs\");\n\nvar descriptor = {\n  data: {\n    required: true,\n    multi: false\n  },\n  config: {}\n};\nfunction downloadPng(_ref) {\n  var datas = _ref.datas,\n    config = _ref.config;\n  var svgElement = datas[0];\n  var uriPromise = (0,_imgUtil_mjs__WEBPACK_IMPORTED_MODULE_0__.svgToPngURI)(svgElement, \"objectUri\");\n  uriPromise.then(function (uri) {\n    var link = document.createElement(\"a\");\n    link.download = \"pic.png\";\n    link.href = uri;\n    link.click();\n    return \"success\";\n  }).catch(function (error) {\n    console.error(error);\n    return null;\n  });\n  return uriPromise;\n}\n\n\n//# sourceURL=webpack:///./src/mod_exportChart/png.mjs?");

/***/ }),

/***/ "./src/mod_exportChart/svg.mjs":
/*!*************************************!*\
  !*** ./src/mod_exportChart/svg.mjs ***!
  \*************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"descriptor\": () => (/* binding */ descriptor),\n/* harmony export */   \"produce\": () => (/* binding */ downloadSvg)\n/* harmony export */ });\n/* harmony import */ var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../node_modules/core-js/modules/es.object.to-string.js\");\n/* harmony import */ var core_js_modules_es_promise_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.promise.js */ \"../node_modules/core-js/modules/es.promise.js\");\n/* harmony import */ var _imgUtil_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_imgUtil.mjs */ \"./src/mod_exportChart/_imgUtil.mjs\");\n\n\n\nvar descriptor = {\n  data: {\n    required: true,\n    multi: false\n  },\n  config: {}\n};\nfunction downloadSvg(_ref) {\n  var datas = _ref.datas,\n    config = _ref.config;\n  var promise = new Promise(function (resolve) {\n    var svgElement = datas[0];\n    var uri = (0,_imgUtil_mjs__WEBPACK_IMPORTED_MODULE_2__.svgURI)(svgElement, \"objectUri\");\n    var link = document.createElement(\"a\");\n    link.download = \"pic.svg\";\n    link.href = uri;\n    link.click();\n    resolve(\"success\");\n  }).catch(function (error) {\n    console.error(error);\n    return null;\n  });\n  return promise;\n}\n\n\n//# sourceURL=webpack:///./src/mod_exportChart/svg.mjs?");

/***/ })

}]);